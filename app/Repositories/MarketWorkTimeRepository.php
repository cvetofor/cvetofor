<?php

namespace App\Repositories;

use App\Models\MarketWorkTime;
use Illuminate\Database\Eloquent\Builder;
use A17\Twill\Repositories\ModuleRepository;
use A17\Twill\Repositories\Behaviors\HandleRevisions;

class MarketWorkTimeRepository extends ModuleRepository
{
    use HandleRevisions;

    protected array $fieldsGroups = [
        'times' => [
            'monday0000',
            'tuesday0000',
            'wednesday0000',
            'thursday0000',
            'friday0000',
            'saturday0000',
            'sunday0000',
            'monday0030',
            'tuesday0030',
            'wednesday0030',
            'thursday0030',
            'friday0030',
            'saturday0030',
            'sunday0030',
            'monday0100',
            'tuesday0100',
            'wednesday0100',
            'thursday0100',
            'friday0100',
            'saturday0100',
            'sunday0100',
            'monday0130',
            'tuesday0130',
            'wednesday0130',
            'thursday0130',
            'friday0130',
            'saturday0130',
            'sunday0130',
            'monday0200',
            'tuesday0200',
            'wednesday0200',
            'thursday0200',
            'friday0200',
            'saturday0200',
            'sunday0200',
            'monday0230',
            'tuesday0230',
            'wednesday0230',
            'thursday0230',
            'friday0230',
            'saturday0230',
            'sunday0230',
            'monday0300',
            'tuesday0300',
            'wednesday0300',
            'thursday0300',
            'friday0300',
            'saturday0300',
            'sunday0300',
            'monday0330',
            'tuesday0330',
            'wednesday0330',
            'thursday0330',
            'friday0330',
            'saturday0330',
            'sunday0330',
            'monday0400',
            'tuesday0400',
            'wednesday0400',
            'thursday0400',
            'friday0400',
            'saturday0400',
            'sunday0400',
            'monday0430',
            'tuesday0430',
            'wednesday0430',
            'thursday0430',
            'friday0430',
            'saturday0430',
            'sunday0430',
            'monday0500',
            'tuesday0500',
            'wednesday0500',
            'thursday0500',
            'friday0500',
            'saturday0500',
            'sunday0500',
            'monday0530',
            'tuesday0530',
            'wednesday0530',
            'thursday0530',
            'friday0530',
            'saturday0530',
            'sunday0530',
            'monday0600',
            'tuesday0600',
            'wednesday0600',
            'thursday0600',
            'friday0600',
            'saturday0600',
            'sunday0600',
            'monday0630',
            'tuesday0630',
            'wednesday0630',
            'thursday0630',
            'friday0630',
            'saturday0630',
            'sunday0630',
            'monday0700',
            'tuesday0700',
            'wednesday0700',
            'thursday0700',
            'friday0700',
            'saturday0700',
            'sunday0700',
            'monday0730',
            'tuesday0730',
            'wednesday0730',
            'thursday0730',
            'friday0730',
            'saturday0730',
            'sunday0730',
            'monday0800',
            'tuesday0800',
            'wednesday0800',
            'thursday0800',
            'friday0800',
            'saturday0800',
            'sunday0800',
            'monday0830',
            'tuesday0830',
            'wednesday0830',
            'thursday0830',
            'friday0830',
            'saturday0830',
            'sunday0830',
            'monday0900',
            'tuesday0900',
            'wednesday0900',
            'thursday0900',
            'friday0900',
            'saturday0900',
            'sunday0900',
            'monday0930',
            'tuesday0930',
            'wednesday0930',
            'thursday0930',
            'friday0930',
            'saturday0930',
            'sunday0930',
            'monday1000',
            'tuesday1000',
            'wednesday1000',
            'thursday1000',
            'friday1000',
            'saturday1000',
            'sunday1000',
            'monday1030',
            'tuesday1030',
            'wednesday1030',
            'thursday1030',
            'friday1030',
            'saturday1030',
            'sunday1030',
            'monday1100',
            'tuesday1100',
            'wednesday1100',
            'thursday1100',
            'friday1100',
            'saturday1100',
            'sunday1100',
            'monday1130',
            'tuesday1130',
            'wednesday1130',
            'thursday1130',
            'friday1130',
            'saturday1130',
            'sunday1130',
            'monday1200',
            'tuesday1200',
            'wednesday1200',
            'thursday1200',
            'friday1200',
            'saturday1200',
            'sunday1200',
            'monday1230',
            'tuesday1230',
            'wednesday1230',
            'thursday1230',
            'friday1230',
            'saturday1230',
            'sunday1230',
            'monday1300',
            'tuesday1300',
            'wednesday1300',
            'thursday1300',
            'friday1300',
            'saturday1300',
            'sunday1300',
            'monday1330',
            'tuesday1330',
            'wednesday1330',
            'thursday1330',
            'friday1330',
            'saturday1330',
            'sunday1330',
            'monday1400',
            'tuesday1400',
            'wednesday1400',
            'thursday1400',
            'friday1400',
            'saturday1400',
            'sunday1400',
            'monday1430',
            'tuesday1430',
            'wednesday1430',
            'thursday1430',
            'friday1430',
            'saturday1430',
            'sunday1430',
            'monday1500',
            'tuesday1500',
            'wednesday1500',
            'thursday1500',
            'friday1500',
            'saturday1500',
            'sunday1500',
            'monday1530',
            'tuesday1530',
            'wednesday1530',
            'thursday1530',
            'friday1530',
            'saturday1530',
            'sunday1530',
            'monday1600',
            'tuesday1600',
            'wednesday1600',
            'thursday1600',
            'friday1600',
            'saturday1600',
            'sunday1600',
            'monday1630',
            'tuesday1630',
            'wednesday1630',
            'thursday1630',
            'friday1630',
            'saturday1630',
            'sunday1630',
            'monday1700',
            'tuesday1700',
            'wednesday1700',
            'thursday1700',
            'friday1700',
            'saturday1700',
            'sunday1700',
            'monday1730',
            'tuesday1730',
            'wednesday1730',
            'thursday1730',
            'friday1730',
            'saturday1730',
            'sunday1730',
            'monday1800',
            'tuesday1800',
            'wednesday1800',
            'thursday1800',
            'friday1800',
            'saturday1800',
            'sunday1800',
            'monday1830',
            'tuesday1830',
            'wednesday1830',
            'thursday1830',
            'friday1830',
            'saturday1830',
            'sunday1830',
            'monday1900',
            'tuesday1900',
            'wednesday1900',
            'thursday1900',
            'friday1900',
            'saturday1900',
            'sunday1900',
            'monday1930',
            'tuesday1930',
            'wednesday1930',
            'thursday1930',
            'friday1930',
            'saturday1930',
            'sunday1930',
            'monday2000',
            'tuesday2000',
            'wednesday2000',
            'thursday2000',
            'friday2000',
            'saturday2000',
            'sunday2000',
            'monday2030',
            'tuesday2030',
            'wednesday2030',
            'thursday2030',
            'friday2030',
            'saturday2030',
            'sunday2030',
            'monday2100',
            'tuesday2100',
            'wednesday2100',
            'thursday2100',
            'friday2100',
            'saturday2100',
            'sunday2100',
            'monday2130',
            'tuesday2130',
            'wednesday2130',
            'thursday2130',
            'friday2130',
            'saturday2130',
            'sunday2130',
            'monday2200',
            'tuesday2200',
            'wednesday2200',
            'thursday2200',
            'friday2200',
            'saturday2200',
            'sunday2200',
            'monday2230',
            'tuesday2230',
            'wednesday2230',
            'thursday2230',
            'friday2230',
            'saturday2230',
            'sunday2230',
            'monday2300',
            'tuesday2300',
            'wednesday2300',
            'thursday2300',
            'friday2300',
            'saturday2300',
            'sunday2300',
            'monday2330',
            'tuesday2330',
            'wednesday2330',
            'thursday2330',
            'friday2330',
            'saturday2330',
            'sunday2330',
        ],
    ];

    # The below can be setup optionally, documented below.

    public bool $fieldsGroupsFormFieldNamesAutoPrefix = true;

    public string $fieldsGroupsFormFieldNameSeparator = '_';

    public function __construct(MarketWorkTime $model)
    {
        $this->model = $model;
    }

    public function filter($query, array $scopes = []): Builder
    {

        $query = $query->whereHas('market', function($q)
        {
            return $q->where('id',auth('twill_users')->user()->getMarketId());
        })->orWhereHas('delivery', function($q)
        {
            return $q->where('id',auth('twill_users')->user()->getMarketId());
        });

        return parent::filter($query, $scopes);
    }
}
